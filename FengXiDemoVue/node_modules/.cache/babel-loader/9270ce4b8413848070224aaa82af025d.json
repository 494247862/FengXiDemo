{"remainingRequest":"D:\\svn\\FengXiDemo\\FengXiDemoVue\\node_modules\\babel-loader\\lib\\index.js!D:\\svn\\FengXiDemo\\FengXiDemoVue\\src\\store\\modules\\user.js","dependencies":[{"path":"D:\\svn\\FengXiDemo\\FengXiDemoVue\\src\\store\\modules\\user.js","mtime":1686639387688},{"path":"D:\\svn\\FengXiDemo\\FengXiDemoVue\\babel.config.js","mtime":1686639387190},{"path":"D:\\svn\\FengXiDemo\\FengXiDemoVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\svn\\FengXiDemo\\FengXiDemoVue\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmpzb24uc3RyaW5naWZ5LmpzIjsKaW1wb3J0IHsgbG9naW4gYXMgX2xvZ2luLCBsb2dvdXQgYXMgX2xvZ291dCwgZ2V0SW5mbyBhcyBfZ2V0SW5mbyB9IGZyb20gJ0AvYXBpL3VzZXInOwppbXBvcnQgeyBnZXRCdXR0b25CeUN1cnJlbnQgYXMgX2dldEJ1dHRvbkJ5Q3VycmVudCB9IGZyb20gJ0AvYXBpL2J1dHRvbic7CmltcG9ydCB7IGdldFRva2VuLCBzZXRUb2tlbiwgcmVtb3ZlVG9rZW4gfSBmcm9tICdAL3V0aWxzL2F1dGgnOwppbXBvcnQgeyByZXNldFJvdXRlciB9IGZyb20gJ0Avcm91dGVyJzsKdmFyIGdldERlZmF1bHRTdGF0ZSA9IGZ1bmN0aW9uIGdldERlZmF1bHRTdGF0ZSgpIHsKICByZXR1cm4gewogICAgdG9rZW46IGdldFRva2VuKCksCiAgICBuYW1lOiAnJywKICAgIGF2YXRhcjogJycKICB9Owp9Owp2YXIgc3RhdGUgPSBnZXREZWZhdWx0U3RhdGUoKTsKdmFyIG11dGF0aW9ucyA9IHsKICBSRVNFVF9TVEFURTogZnVuY3Rpb24gUkVTRVRfU1RBVEUoc3RhdGUpIHsKICAgIE9iamVjdC5hc3NpZ24oc3RhdGUsIGdldERlZmF1bHRTdGF0ZSgpKTsKICB9LAogIFNFVF9UT0tFTjogZnVuY3Rpb24gU0VUX1RPS0VOKHN0YXRlLCB0b2tlbikgewogICAgc3RhdGUudG9rZW4gPSB0b2tlbjsKICB9LAogIFNFVF9OQU1FOiBmdW5jdGlvbiBTRVRfTkFNRShzdGF0ZSwgbmFtZSkgewogICAgc3RhdGUubmFtZSA9IG5hbWU7CiAgfSwKICBTRVRfQUNDT1VOVDogZnVuY3Rpb24gU0VUX0FDQ09VTlQoc3RhdGUsIGFjY291bnQpIHsKICAgIHN0YXRlLmFjY291bnQgPSBhY2NvdW50OwogIH0sCiAgU0VUX0FWQVRBUjogZnVuY3Rpb24gU0VUX0FWQVRBUihzdGF0ZSwgYXZhdGFyKSB7CiAgICBzdGF0ZS5hdmF0YXIgPSBhdmF0YXI7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IHsKICAvLyB1c2VyIGxvZ2luCiAgbG9naW46IGZ1bmN0aW9uIGxvZ2luKF9yZWYsIHVzZXJJbmZvKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICB2YXIgYWNjb3VudCA9IHVzZXJJbmZvLmFjY291bnQsCiAgICAgIHBhc3N3b3JkID0gdXNlckluZm8ucGFzc3dvcmQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBfbG9naW4oewogICAgICAgIGFjY291bnQ6IGFjY291bnQudHJpbSgpLAogICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZAogICAgICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCBkYXRhLnRva2VuKTsKICAgICAgICBzZXRUb2tlbihkYXRhLnRva2VuKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyBnZXQgdXNlciBpbmZvCiAgZ2V0SW5mbzogZnVuY3Rpb24gZ2V0SW5mbyhfcmVmMikgewogICAgdmFyIGNvbW1pdCA9IF9yZWYyLmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIF9nZXRJbmZvKCkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIGlmICghZGF0YSkgewogICAgICAgICAgcmVqZWN0KCfpqozor4HlpLHotKXvvIzor7fph43mlrDnmbvlvZUnKTsKICAgICAgICB9CiAgICAgICAgdmFyIG5pY2tOYW1lID0gZGF0YS5uaWNrTmFtZSwKICAgICAgICAgIGF2YXRhciA9IGRhdGEuYXZhdGFyLAogICAgICAgICAgYWNjb3VudCA9IGRhdGEuYWNjb3VudDsKICAgICAgICBjb21taXQoJ1NFVF9OQU1FJywgbmlja05hbWUpOwogICAgICAgIGNvbW1pdCgnU0VUX0FDQ09VTlQnLCBhY2NvdW50KTsKICAgICAgICBjb21taXQoJ1NFVF9BVkFUQVInLCBhdmF0YXIpOwogICAgICAgIHJlc29sdmUoZGF0YSk7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXInLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyDojrflj5bmjInpkq7mnYPpmZAKICBnZXRCdXR0b25CeUN1cnJlbnQ6IGZ1bmN0aW9uIGdldEJ1dHRvbkJ5Q3VycmVudCgpIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIF9nZXRCdXR0b25CeUN1cnJlbnQoKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndXNlckJ1dHRvbnMnLCBKU09OLnN0cmluZ2lmeShyZXMpKTsKICAgICAgICByZXNvbHZlKHJlcyk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyB1c2VyIGxvZ291dAogIGxvZ291dDogZnVuY3Rpb24gbG9nb3V0KF9yZWYzKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjMuY29tbWl0LAogICAgICBzdGF0ZSA9IF9yZWYzLnN0YXRlOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2xvZ291dChzdGF0ZS50b2tlbikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmVtb3ZlVG9rZW4oKTsgLy8gbXVzdCByZW1vdmUgIHRva2VuICBmaXJzdAogICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyJyk7CiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXJCdXR0b25zJyk7CiAgICAgICAgcmVzZXRSb3V0ZXIoKTsKICAgICAgICBjb21taXQoJ1JFU0VUX1NUQVRFJyk7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgLy8gcmVtb3ZlIHRva2VuCiAgcmVzZXRUb2tlbjogZnVuY3Rpb24gcmVzZXRUb2tlbihfcmVmNCkgewogICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICByZW1vdmVUb2tlbigpOyAvLyBtdXN0IHJlbW92ZSAgdG9rZW4gIGZpcnN0CiAgICAgIGNvbW1pdCgnUkVTRVRfU1RBVEUnKTsKICAgICAgcmVzb2x2ZSgpOwogICAgfSk7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogc3RhdGUsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMsCiAgYWN0aW9uczogYWN0aW9ucwp9Ow=="},{"version":3,"names":["login","logout","getInfo","getButtonByCurrent","getToken","setToken","removeToken","resetRouter","getDefaultState","token","name","avatar","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_ACCOUNT","account","SET_AVATAR","actions","userInfo","commit","password","Promise","resolve","reject","trim","then","data","catch","error","nickName","localStorage","setItem","JSON","stringify","res","removeItem","resetToken","namespaced"],"sources":["D:/svn/FengXiDemo/FengXiDemoVue/src/store/modules/user.js"],"sourcesContent":["import { login, logout, getInfo } from '@/api/user'\nimport { getButtonByCurrent } from '@/api/button'\nimport { getToken, setToken, removeToken } from '@/utils/auth'\nimport { resetRouter } from '@/router'\n\nconst getDefaultState = () => {\n  return {\n    token: getToken(),\n    name: '',\n    avatar: ''\n  }\n}\n\nconst state = getDefaultState()\n\nconst mutations = {\n  RESET_STATE: (state) => {\n    Object.assign(state, getDefaultState())\n  },\n  SET_TOKEN: (state, token) => {\n    state.token = token\n  },\n  SET_NAME: (state, name) => {\n    state.name = name\n  },\n  SET_ACCOUNT: (state, account) => {\n    state.account = account\n  },\n  SET_AVATAR: (state, avatar) => {\n    state.avatar = avatar\n  }\n}\n\nconst actions = {\n  // user login\n  login({ commit }, userInfo) {\n    const { account, password } = userInfo\n    return new Promise((resolve, reject) => {\n      login({ account: account.trim(), password: password }).then(data => {\n        commit('SET_TOKEN', data.token)\n        setToken(data.token)\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // get user info\n  getInfo({ commit }) {\n    return new Promise((resolve, reject) => {\n      getInfo().then(data => {\n        if (!data) {\n          reject('验证失败，请重新登录')\n        }\n\n        const { nickName, avatar, account } = data\n        commit('SET_NAME', nickName)\n        commit('SET_ACCOUNT', account)\n        commit('SET_AVATAR', avatar)\n        resolve(data)\n        localStorage.setItem('user', JSON.stringify(data))\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // 获取按钮权限\n  getButtonByCurrent() {\n    return new Promise((resolve, reject) => {\n      getButtonByCurrent().then(res => {\n        localStorage.setItem('userButtons', JSON.stringify(res))\n        resolve(res)\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // user logout\n  logout({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      logout(state.token).then(() => {\n        removeToken() // must remove  token  first\n        localStorage.removeItem('user')\n        localStorage.removeItem('userButtons')\n        resetRouter()\n        commit('RESET_STATE')\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // remove token\n  resetToken({ commit }) {\n    return new Promise(resolve => {\n      removeToken() // must remove  token  first\n      commit('RESET_STATE')\n      resolve()\n    })\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n}\n\n"],"mappings":"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"}]}